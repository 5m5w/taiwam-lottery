import sqlite3
import pandas as pd
import requests
from datetime import datetime 

conn = sqlite3.connect('2014年至今中獎號碼.db')

datenow = datetime.now()
date1 = pd.date_range("20140101", datenow, freq="m")

for i in date1:
    y = str(int(str(i)[:4])-1911)
    m = str(int(str(i)[5:7]))
    
    url = "https://www.taiwanlottery.com.tw/lotto/superlotto638/history.aspx"

    payload = {'__VIEWSTATE': '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',
    '__VIEWSTATEGENERATOR':'D75607D0',
    '__EVENTVALIDATION': 'dCT6bv29MdSFg/7XEzdzMpu9dvFHoD406s0q6kVMKw9SNqANUDkgTpS6bs/VN+oJ00ELMtfXrN4sm8t0Rb+6eTZD8If4xYiSBhZkVzEwlRifycsXUzP0lj2Oh0nlWNT3ImFD+dUJsb1bESN5QE/UlRsmQGY/8NTIqRVqxFKZE6mGwIXe+pL1x9itMLmW5EDtp/PyV0KgVZiZhWk80z+DZI4c2u3DGv9HrXWw7cd3EgD1QxpTiF3JiK+TWsjKLAeziLZHwvtz8QsJpnbkTUrWYIVZWV60vWqQtvbhITf5oJs+rDmaaM2ibni9ZKvLIGzCeBkp9kYLPkI2DVWaKoEWvyYrFlwFCi9+8GxXPm6UDbjoIbihS7SRI2JbpkuWDGXWwtYa+ePdSkZxR+t+drQp4A+K6wEkgLZCcrcWkoZhulXSN+Cnu0jxC/X0uOY/0BDUg8oaT5o7/1Uoo7X3pfbyjQB3WVHs9JIncMRJfwRqYG+QZbC1Rl0nnyuaCBOJJ+mVeqoVSTZhJVXbtAYJ5H/KScl6Hi7YOJ1nS42eHVKasztwnHBYhmJNN2vdkcEfdYn9MbPyxC0B2A/h3xKlbIVCcGjl+gdkHGf8yolFbToxAxwBG00PZwDK3vFXTVYBg6A5l/XOTFsSqjMcnpDR0+p9SVv+zzs=',
    'forma':'請選擇遊戲',
    'SuperLotto638Control_history1$txtNO':'',
    'SuperLotto638Control_history1$chk':'radYM',
    'SuperLotto638Control_history1$dropYear': y,
    'SuperLotto638Control_history1$dropMonth': m,
    'SuperLotto638Control_history1$btnSubmit':'查詢'}
    
    resp = requests.post(url, payload)
    list1 = pd.read_html(resp.text)
    print(list1)
    
    colName = ['期別', '開獎日', '兌獎截止', '銷售金額', '獎金總額', '獎號1', '獎號2', '獎號3', '獎號4', '獎號5', '獎號6', '特別號']
        
    for d in list1[2:10]:
        data=[]
        data.append(d.iloc[1,0]) #期別
        data.append(d.iloc[1,2]) #開獎日
        data.append(d.iloc[1,4]) #兌獎截止
        data.append(d.iloc[1,6]) #銷售金額
        data.append(d.iloc[1,8]) #獎金總額
        for i in range(3,10): #六個中獎號與一個特別號
            data.append(d.iloc[5,i])
        dftemp=pd.DataFrame([data], columns=colName)
        #print(dftemp)
        
        sql = 'Select * from 大樂透1206 where 期別"' + data[0] + '"'
        
        try:
            dfcheck = pd.read_sql(sql, conn)
        except:
            dfcheck = pd.DataFrame(columns=colName)
            
        if len(dfcheck) == 0:
            dftemp.to_sql('大樂透1206', conn, if_exists='append', index=False)
        print("--------")
